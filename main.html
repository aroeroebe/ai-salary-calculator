<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>実質時給計算機 — AIライター向け</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Mono:wght@400;500&family=Noto+Sans+JP:wght@400;500;700&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --ink: #1a1a2e;
    --paper: #f5f0e8;
    --cream: #ede8dc;
    --accent: #c84b31;
    --gold: #d4a853;
    --muted: #7a7468;
    --good: #2d6a4f;
    --warn: #e76f51;
    --border: rgba(26,26,46,0.12);
    --shadow: 0 4px 24px rgba(26,26,46,0.08);
  }

  body {
    font-family: 'Noto Sans JP', sans-serif;
    background-color: var(--paper);
    color: var(--ink);
    min-height: 100vh;
    padding: 0;
    background-image:
      repeating-linear-gradient(0deg, transparent, transparent 31px, rgba(200,75,49,0.04) 31px, rgba(200,75,49,0.04) 32px),
      repeating-linear-gradient(90deg, transparent, transparent 31px, rgba(200,75,49,0.04) 31px, rgba(200,75,49,0.04) 32px);
  }

  header {
    background-color: var(--ink);
    color: var(--paper);
    padding: 28px 24px 24px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  header::before {
    content: '';
    position: absolute;
    top: -40px; right: -40px;
    width: 180px; height: 180px;
    border-radius: 50%;
    background: rgba(212,168,83,0.15);
    pointer-events: none;
  }

  header::after {
    content: '';
    position: absolute;
    bottom: -60px; left: -20px;
    width: 140px; height: 140px;
    border-radius: 50%;
    background: rgba(200,75,49,0.12);
    pointer-events: none;
  }

  .header-label {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.2em;
    color: var(--gold);
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  header h1 {
    font-family: 'DM Serif Display', serif;
    font-size: clamp(22px, 5vw, 34px);
    font-weight: 400;
    letter-spacing: -0.01em;
    line-height: 1.2;
  }

  header p {
    font-size: 13px;
    color: rgba(245,240,232,0.55);
    margin-top: 8px;
    font-weight: 400;
  }

  .container {
    max-width: 540px;
    margin: 0 auto;
    padding: 32px 20px 60px;
  }

  .card {
    background: #fff;
    border-radius: 2px;
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
    overflow: hidden;
  }

  .card-section {
    padding: 24px 24px 20px;
    border-bottom: 1px solid var(--border);
  }

  .section-title {
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.18em;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .section-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  .field {
    margin-bottom: 16px;
  }

  .field:last-child { margin-bottom: 0; }

  label {
    display: block;
    font-size: 12px;
    font-weight: 500;
    color: var(--muted);
    margin-bottom: 6px;
    letter-spacing: 0.02em;
  }

  .input-wrap {
    position: relative;
    display: flex;
    align-items: center;
  }

  input[type="number"] {
    width: 100%;
    padding: 10px 40px 10px 14px;
    font-family: 'DM Mono', monospace;
    font-size: 15px;
    font-weight: 500;
    color: var(--ink);
    background: var(--paper);
    border: 1.5px solid var(--border);
    border-radius: 2px;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    -moz-appearance: textfield;
  }

  input[type="number"]::-webkit-inner-spin-button,
  input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; }

  input[type="number"]:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(200,75,49,0.1);
    background: #fff;
  }

  .unit {
    position: absolute;
    right: 12px;
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    color: var(--muted);
    pointer-events: none;
  }

  .field-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .btn-area {
    padding: 20px 24px;
  }

  .btn-row {
    display: flex;
    gap: 8px;
  }

  button {
    padding: 14px;
    border: none;
    border-radius: 2px;
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.06em;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
    position: relative;
    overflow: hidden;
  }

  button:active { transform: scale(0.99); }

  .btn-primary {
    flex: 1;
    background: var(--ink);
    color: var(--paper);
  }

  .btn-primary:hover { background: #2d2d4e; }

  .btn-primary::after {
    content: '→';
    position: absolute;
    right: 14px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 16px;
    opacity: 0.5;
  }

  .btn-ghost {
    background: transparent;
    color: var(--muted);
    border: 1.5px solid var(--border);
    padding: 14px 16px;
    font-size: 12px;
    letter-spacing: 0.04em;
  }

  .btn-ghost:hover { background: var(--paper); color: var(--ink); border-color: var(--muted); }

  /* Result */
  .result-card {
    margin-top: 20px;
    background: #fff;
    border: 1px solid var(--border);
    border-radius: 2px;
    box-shadow: var(--shadow);
    overflow: hidden;
    display: none;
    animation: slideUp 0.35s cubic-bezier(0.22,1,0.36,1);
  }

  @keyframes slideUp {
    from { opacity: 0; transform: translateY(16px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .result-header {
    background: var(--ink);
    color: var(--paper);
    padding: 16px 24px;
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: var(--gold);
  }

  .result-body { padding: 0 24px 24px; }

  .hourly-big {
    padding: 24px 0 20px;
    border-bottom: 1px solid var(--border);
    text-align: center;
  }

  .hourly-label {
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 0.08em;
    margin-bottom: 6px;
  }

  .hourly-value {
    font-family: 'DM Serif Display', serif;
    font-size: clamp(42px, 10vw, 64px);
    line-height: 1;
    letter-spacing: -0.02em;
  }

  .hourly-value .yen { font-size: 0.45em; vertical-align: super; margin-right: 4px; }

  .eval-badge {
    display: inline-block;
    margin-top: 12px;
    padding: 5px 16px;
    border-radius: 40px;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 0.06em;
  }

  .eval-good  { background: rgba(45,106,79,0.1);  color: var(--good); }
  .eval-norm  { background: rgba(212,168,83,0.15); color: #9a7000; }
  .eval-warn  { background: rgba(231,111,81,0.12); color: var(--warn); }

  .metrics {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: var(--border);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin-top: 20px;
  }

  .metric {
    background: var(--paper);
    padding: 14px 16px;
  }

  .metric-label {
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 0.08em;
    margin-bottom: 4px;
  }

  .metric-value {
    font-family: 'DM Mono', monospace;
    font-size: 16px;
    font-weight: 500;
    color: var(--ink);
  }

  .metric-unit {
    font-size: 11px;
    color: var(--muted);
    margin-left: 2px;
  }

  @media (max-width: 400px) {
    .field-row { grid-template-columns: 1fr; }
    .metrics { grid-template-columns: 1fr; }
    .btn-row { flex-direction: column; }
    .btn-primary::after { display: none; }
  }
</style>
</head>
<body>

<header>
  <div class="header-label">AIライター向けツール</div>
  <h1>実質時給計算機</h1>
  <p>案件ごとの実質時給を正確に把握しよう</p>
</header>

<div class="container">

  <div class="card">
    <div class="card-section">
      <div class="section-title">案件情報</div>

      <div class="field-row">
        <div class="field">
          <label>文字単価</label>
          <div class="input-wrap">
            <input type="number" id="charPrice" placeholder="1.5" min="0" step="0.1">
            <span class="unit">円</span>
          </div>
        </div>
        <div class="field">
          <label>記事文字数</label>
          <div class="input-wrap">
            <input type="number" id="charCount" placeholder="3000" min="0">
            <span class="unit">字</span>
          </div>
        </div>
      </div>

      <div class="field">
        <label>初回作業時間</label>
        <div class="input-wrap">
          <input type="number" id="workTime" placeholder="90" min="0">
          <span class="unit">分</span>
        </div>
      </div>
    </div>

    <div class="card-section">
      <div class="section-title">修正情報</div>

      <div class="field-row">
        <div class="field">
          <label>修正回数</label>
          <div class="input-wrap">
            <input type="number" id="revCount" placeholder="2" min="0">
            <span class="unit">回</span>
          </div>
        </div>
        <div class="field">
          <label>修正1回あたりの時間</label>
          <div class="input-wrap">
            <input type="number" id="revTime" placeholder="20" min="0">
            <span class="unit">分</span>
          </div>
        </div>
      </div>
    </div>

    <div class="btn-area">
      <div class="btn-row">
        <button id="calcBtn" type="button" class="btn-primary">実質時給を計算する</button>
        <button id="copyBtn" type="button" class="btn-ghost">コピー</button>
        <button id="resetBtn" type="button" class="btn-ghost">リセット</button>
      </div>
    </div>
  </div>

  <div id="errorNote" role="alert" aria-live="assertive" style="display:none;margin-top:16px;padding:12px 16px;background:rgba(200,75,49,0.08);border:1.5px solid rgba(200,75,49,0.25);border-radius:2px;font-size:13px;color:var(--accent);font-weight:500;"></div>

  <div class="result-card" id="result" role="status" aria-live="polite">
    <div class="result-header">計算結果</div>
    <div class="result-body">

      <div class="hourly-big">
        <div class="hourly-label">実質時給</div>
        <div class="hourly-value" id="hourlyVal">
          <span class="yen">¥</span><span id="hourlyNum">0</span>
        </div>
        <div><span class="eval-badge" id="evalBadge"></span></div>
      </div>

      <div class="metrics">
        <div class="metric">
          <div class="metric-label">請求額</div>
          <div class="metric-value" id="billing">—<span class="metric-unit">円</span></div>
        </div>
        <div class="metric">
          <div class="metric-label">総作業時間</div>
          <div class="metric-value" id="totalTime">—<span class="metric-unit">分</span></div>
        </div>
        <div class="metric">
          <div class="metric-label">初回作業</div>
          <div class="metric-value" id="initTime">—<span class="metric-unit">分</span></div>
        </div>
        <div class="metric">
          <div class="metric-label">修正作業合計</div>
          <div class="metric-value" id="revTotal">—<span class="metric-unit">分</span></div>
        </div>
      </div>

    </div>
  </div>

</div>

<script>
(function () {
  const el = id => document.getElementById(id);
  const FIELDS = ['charPrice', 'charCount', 'workTime', 'revCount', 'revTime'];
  const LS_KEY = 'ai_writer_jikyuu_v1';

  function fmt(n) { return Math.round(n).toLocaleString('ja-JP'); }

  function parseClamp(id) {
    const v = parseFloat(el(id).value);
    return isFinite(v) ? Math.max(0, v) : 0;
  }

  // localStorage
  function saveInputs() {
    const obj = {};
    FIELDS.forEach(k => { obj[k] = el(k).value; });
    try { localStorage.setItem(LS_KEY, JSON.stringify(obj)); } catch(e) {}
  }

  function loadInputs() {
    try {
      const raw = localStorage.getItem(LS_KEY);
      if (!raw) return;
      const obj = JSON.parse(raw);
      FIELDS.forEach(k => { if (obj[k] !== undefined) el(k).value = obj[k]; });
    } catch(e) {}
  }

  function showError(msg) {
    const note = el('errorNote');
    note.textContent = msg;
    note.style.display = 'block';
    el('result').style.display = 'none';
  }

  function clearError() {
    const note = el('errorNote');
    note.textContent = '';
    note.style.display = 'none';
  }

  function calculate() {
    saveInputs();

    const charPrice = parseClamp('charPrice');
    const charCount = parseClamp('charCount');
    const workTime  = parseClamp('workTime');
    const revCount  = parseClamp('revCount');
    const revTime   = parseClamp('revTime');

    const billing   = charPrice * charCount;
    const revTotal  = revCount * revTime;
    const totalTime = workTime + revTotal;

    if (totalTime <= 0) {
      showError('⚠ 総作業時間が0分です。初回作業時間か修正時間を入力してください。');
      return;
    }
    clearError();

    const hourly = (billing / totalTime) * 60;

    let evalText = '', evalClass = '';
    if (hourly >= 2000) {
      evalText = '✦ 良好 — 高単価案件です'; evalClass = 'eval-good';
    } else if (hourly >= 1200) {
      evalText = '◈ 普通 — 標準的な時給水準'; evalClass = 'eval-norm';
    } else {
      evalText = '▲ 注意 — 時給が低めです'; evalClass = 'eval-warn';
    }

    el('hourlyNum').textContent = fmt(hourly);
    el('billing').innerHTML     = fmt(billing)   + '<span class="metric-unit">円</span>';
    el('totalTime').innerHTML   = fmt(totalTime) + '<span class="metric-unit">分</span>';
    el('initTime').innerHTML    = fmt(workTime)  + '<span class="metric-unit">分</span>';
    el('revTotal').innerHTML    = fmt(revTotal)  + '<span class="metric-unit">分</span>';

    const badge = el('evalBadge');
    badge.textContent = evalText;
    badge.className   = 'eval-badge ' + evalClass;

    const resultEl = el('result');
    resultEl.style.display = 'block';
    resultEl.style.animation = 'none';
    void resultEl.offsetWidth;
    resultEl.style.animation = '';
    resultEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  function resetAll() {
    FIELDS.forEach(k => { el(k).value = ''; });
    try { localStorage.removeItem(LS_KEY); } catch(e) {}
    clearError();
    el('result').style.display = 'none';
  }

  function copyResult() {
    const resultEl = el('result');
    if (resultEl.style.display !== 'block') return;
    const lines = [
      '実質時給: ¥' + el('hourlyNum').textContent + '/時',
      '評価: '      + el('evalBadge').textContent,
      '請求額: '    + el('billing').textContent + '円',
      '総作業時間: ' + el('totalTime').textContent + '分',
    ];
    navigator.clipboard?.writeText(lines.join('
')).then(() => {
      const btn = el('copyBtn');
      const prev = btn.textContent;
      btn.textContent = '✓ コピー済み';
      setTimeout(() => { btn.textContent = prev; }, 1400);
    }).catch(() => {
      alert('コピーに失敗しました。手動で選択してコピーしてください。');
    });
  }

  // init
  loadInputs();
  el('calcBtn').addEventListener('click', calculate);
  el('resetBtn').addEventListener('click', resetAll);
  el('copyBtn').addEventListener('click', copyResult);

  FIELDS.forEach(id => {
    el(id).addEventListener('keydown', function (e) {
      if (e.key === 'Enter') { e.preventDefault(); calculate(); }
    });
    el(id).addEventListener('input', saveInputs);
  });
})();
</script>
</body>
</html>
